2025-11-25 11:48:34,783 - INFO - Starting ETL process...
2025-11-25 11:48:35,140 - ERROR - An error occurred during the ETL process: Failed to parse HTML structure. The website layout may have changed. Details: 'NoneType' object has no attribute 'find_parent'
Traceback (most recent call last):
  File "C:\Users\sandy\.vscode\gold-price-etl\src\scraper.py", line 23, in fetch_gold_price
    gold_bar_row = soup.find('td', string='黃金條塊').find_parent('tr')
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'NoneType' object has no attribute 'find_parent'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\sandy\.vscode\gold-price-etl\main.py", line 38, in main
    raw_price = fetch_gold_price()
  File "C:\Users\sandy\.vscode\gold-price-etl\src\scraper.py", line 35, in fetch_gold_price
    raise ValueError(f"Failed to parse HTML structure. The website layout may have changed. Details: {e}") from e
ValueError: Failed to parse HTML structure. The website layout may have changed. Details: 'NoneType' object has no attribute 'find_parent'
2025-11-25 12:03:59,471 - INFO - Starting ETL process...
2025-11-25 12:04:00,935 - ERROR - An error occurred during the ETL process: Failed to parse HTML structure. The website layout may have changed. Details: Could not find the '黃金條塊' row in the price table.
Traceback (most recent call last):
  File "c:\Users\sandy\.vscode\gold-price-etl\src\scraper.py", line 27, in fetch_gold_price
    raise ValueError("Could not find the '黃金條塊' row in the price table.")
ValueError: Could not find the '黃金條塊' row in the price table.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "c:\Users\sandy\.vscode\gold-price-etl\main.py", line 38, in main
    raw_price = fetch_gold_price()
  File "c:\Users\sandy\.vscode\gold-price-etl\src\scraper.py", line 43, in fetch_gold_price
    raise ValueError(f"Failed to parse HTML structure. The website layout may have changed. Details: {e}") from e
ValueError: Failed to parse HTML structure. The website layout may have changed. Details: Could not find the '黃金條塊' row in the price table.
2025-11-25 12:04:09,429 - INFO - Starting ETL process...
2025-11-25 12:04:09,862 - ERROR - An error occurred during the ETL process: Failed to parse HTML structure. The website layout may have changed. Details: Could not find the '黃金條塊' row in the price table.
Traceback (most recent call last):
  File "c:\Users\sandy\.vscode\gold-price-etl\src\scraper.py", line 27, in fetch_gold_price
    raise ValueError("Could not find the '黃金條塊' row in the price table.")
ValueError: Could not find the '黃金條塊' row in the price table.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "c:\Users\sandy\.vscode\gold-price-etl\main.py", line 38, in main
    raw_price = fetch_gold_price()
  File "c:\Users\sandy\.vscode\gold-price-etl\src\scraper.py", line 43, in fetch_gold_price
    raise ValueError(f"Failed to parse HTML structure. The website layout may have changed. Details: {e}") from e
ValueError: Failed to parse HTML structure. The website layout may have changed. Details: Could not find the '黃金條塊' row in the price table.
2025-11-25 12:08:11,939 - INFO - Starting ETL process...
2025-11-25 12:08:12,297 - ERROR - An error occurred during the ETL process: Failed to parse HTML structure. The website layout may have changed. Details: Could not find the '黃金條塊' row in the price table.
Traceback (most recent call last):
  File "c:\Users\sandy\.vscode\gold-price-etl\src\scraper.py", line 27, in fetch_gold_price
    raise ValueError("Could not find the '黃金條塊' row in the price table.")
ValueError: Could not find the '黃金條塊' row in the price table.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "c:\Users\sandy\.vscode\gold-price-etl\main.py", line 38, in main
    raw_price = fetch_gold_price()
  File "c:\Users\sandy\.vscode\gold-price-etl\src\scraper.py", line 42, in fetch_gold_price
    raise ValueError(f"Failed to parse HTML structure. The website layout may have changed. Details: {e}") from e
ValueError: Failed to parse HTML structure. The website layout may have changed. Details: Could not find the '黃金條塊' row in the price table.
2025-11-25 12:08:21,843 - INFO - Starting ETL process...
2025-11-25 12:08:22,370 - ERROR - An error occurred during the ETL process: Failed to parse HTML structure. The website layout may have changed. Details: Could not find the '黃金條塊' row in the price table.
Traceback (most recent call last):
  File "c:\Users\sandy\.vscode\gold-price-etl\src\scraper.py", line 27, in fetch_gold_price
    raise ValueError("Could not find the '黃金條塊' row in the price table.")
ValueError: Could not find the '黃金條塊' row in the price table.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "c:\Users\sandy\.vscode\gold-price-etl\main.py", line 38, in main
    raw_price = fetch_gold_price()
  File "c:\Users\sandy\.vscode\gold-price-etl\src\scraper.py", line 42, in fetch_gold_price
    raise ValueError(f"Failed to parse HTML structure. The website layout may have changed. Details: {e}") from e
ValueError: Failed to parse HTML structure. The website layout may have changed. Details: Could not find the '黃金條塊' row in the price table.
2025-11-25 12:29:13,066 - INFO - Starting ETL process...
2025-11-25 12:29:13,946 - ERROR - An error occurred during the ETL process: Failed to parse HTML structure. The website layout may have changed. Details: Could not find the '黃金條塊' row in the price table.
Traceback (most recent call last):
  File "c:\Users\sandy\.vscode\gold-price-etl\src\scraper.py", line 30, in fetch_gold_price
    raise ValueError("Could not find the '黃金條塊' row in the price table.")
ValueError: Could not find the '黃金條塊' row in the price table.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "c:\Users\sandy\.vscode\gold-price-etl\main.py", line 38, in main
    raw_price = fetch_gold_price()
  File "c:\Users\sandy\.vscode\gold-price-etl\src\scraper.py", line 45, in fetch_gold_price
    raise ValueError(f"Failed to parse HTML structure. The website layout may have changed. Details: {e}") from e
ValueError: Failed to parse HTML structure. The website layout may have changed. Details: Could not find the '黃金條塊' row in the price table.
2025-11-26 01:12:22,900 - INFO - Starting ETL process...
2025-11-26 01:12:24,336 - INFO - Successfully fetched raw data: {'bank_selling': '4209', 'bank_buying': '4163'}
2025-11-26 01:12:24,337 - INFO - Data validation result: Prices={'bank_selling_price': 4209.0, 'bank_buying_price': 4163.0}, Status=OK
2025-11-26 01:12:24,337 - ERROR - An error occurred during the ETL process: table gold_prices has no column named bank_selling_price
Traceback (most recent call last):
  File "/home/runner/work/gold-price-etl/gold-price-etl/main.py", line 49, in main
    db_manager.insert_price(
  File "/home/runner/work/gold-price-etl/gold-price-etl/src/db_manager.py", line 49, in insert_price
    cursor.execute(
sqlite3.OperationalError: table gold_prices has no column named bank_selling_price
2025-11-26 01:19:58,708 - INFO - Starting ETL process...
2025-11-26 01:19:59,711 - INFO - Successfully fetched raw data: {'bank_selling': '4208', 'bank_buying': '4162'}
2025-11-26 01:19:59,712 - INFO - Data validation result: Prices={'bank_selling_price': 4208.0, 'bank_buying_price': 4162.0}, Status=OK
2025-11-26 01:19:59,712 - ERROR - An error occurred during the ETL process: table gold_prices has no column named bank_selling_price
Traceback (most recent call last):
  File "/home/runner/work/gold-price-etl/gold-price-etl/main.py", line 49, in main
    db_manager.insert_price(
  File "/home/runner/work/gold-price-etl/gold-price-etl/src/db_manager.py", line 49, in insert_price
    cursor.execute(
sqlite3.OperationalError: table gold_prices has no column named bank_selling_price
2025-11-26 01:29:10,197 - INFO - Starting ETL process...
2025-11-26 01:29:10,990 - INFO - Successfully fetched raw data: {'bank_selling': '4208', 'bank_buying': '4162'}
2025-11-26 01:29:10,990 - INFO - Data validation result: Prices={'bank_selling_price': 4208.0, 'bank_buying_price': 4162.0}, Status=OK
2025-11-26 01:29:10,992 - INFO - Successfully inserted data into the database.
2025-11-26 03:13:57,867 - INFO - Starting ETL process...
2025-11-26 03:13:58,637 - INFO - Successfully fetched raw data: {'bank_selling': '4220', 'bank_buying': '4174'}
2025-11-26 03:13:58,637 - INFO - Data validation result: Prices={'bank_selling_price': 4220.0, 'bank_buying_price': 4174.0}, Status=OK
2025-11-26 03:13:58,638 - INFO - Successfully inserted data into the database.
2025-11-26 04:24:50,321 - INFO - Starting ETL process...
2025-11-26 04:24:51,129 - INFO - Successfully fetched raw data: {'bank_selling': '4214', 'bank_buying': '4168'}
2025-11-26 04:24:51,129 - INFO - Data validation result: Prices={'bank_selling_price': 4214.0, 'bank_buying_price': 4168.0}, Status=OK
2025-11-26 04:24:51,131 - INFO - Successfully inserted data into the database.
2025-11-26 05:18:29,271 - INFO - Starting ETL process...
2025-11-26 05:18:30,519 - INFO - Successfully fetched raw data: {'bank_selling': '4217', 'bank_buying': '4171'}
2025-11-26 05:18:30,519 - INFO - Data validation result: Prices={'bank_selling_price': 4217.0, 'bank_buying_price': 4171.0}, Status=OK
2025-11-26 05:18:30,523 - INFO - Successfully inserted data into the database.
2025-11-26 06:29:32,245 - INFO - Starting ETL process...
2025-11-26 06:29:33,179 - INFO - Successfully fetched raw data: {'bank_selling': '4209', 'bank_buying': '4163'}
2025-11-26 06:29:33,180 - INFO - Data validation result: Prices={'bank_selling_price': 4209.0, 'bank_buying_price': 4163.0}, Status=OK
2025-11-26 06:29:33,182 - INFO - Successfully inserted data into the database.
2025-11-26 07:18:21,377 - INFO - Starting ETL process...
2025-11-26 07:18:22,290 - INFO - Successfully fetched raw data: {'bank_selling': '4208', 'bank_buying': '4162'}
2025-11-26 07:18:22,291 - INFO - Data validation result: Prices={'bank_selling_price': 4208.0, 'bank_buying_price': 4162.0}, Status=OK
2025-11-26 07:18:22,293 - INFO - Successfully inserted data into the database.
2025-11-26 08:26:14,233 - INFO - Starting ETL process...
2025-11-26 08:26:14,709 - INFO - Successfully fetched raw data: {'bank_selling': '4221', 'bank_buying': '4171'}
2025-11-26 08:26:14,709 - INFO - Data validation result: Prices={'bank_selling_price': 4221.0, 'bank_buying_price': 4171.0}, Status=OK
2025-11-26 08:26:14,711 - INFO - Successfully inserted data into the database.
2025-11-26 09:21:33,382 - INFO - Starting ETL process...
2025-11-26 09:21:33,813 - INFO - Successfully fetched raw data: {'bank_selling': '4217', 'bank_buying': '4167'}
2025-11-26 09:21:33,813 - INFO - Data validation result: Prices={'bank_selling_price': 4217.0, 'bank_buying_price': 4167.0}, Status=OK
2025-11-26 09:21:33,815 - INFO - Successfully inserted data into the database.
2025-11-26 10:21:45,221 - INFO - Starting ETL process...
2025-11-26 10:21:45,618 - INFO - Successfully fetched raw data: {'bank_selling': '4218', 'bank_buying': '4168'}
2025-11-26 10:21:45,618 - INFO - Data validation result: Prices={'bank_selling_price': 4218.0, 'bank_buying_price': 4168.0}, Status=OK
2025-11-26 10:21:45,620 - INFO - Successfully inserted data into the database.
2025-11-26 11:16:52,447 - INFO - Starting ETL process...
2025-11-26 11:16:52,890 - INFO - Successfully fetched raw data: {'bank_selling': '4212', 'bank_buying': '4162'}
2025-11-26 11:16:52,891 - INFO - Data validation result: Prices={'bank_selling_price': 4212.0, 'bank_buying_price': 4162.0}, Status=OK
2025-11-26 11:16:52,892 - INFO - Successfully inserted data into the database.
2025-11-26 12:40:32,260 - INFO - Starting ETL process...
2025-11-26 12:40:32,854 - INFO - Successfully fetched raw data: {'bank_selling': '4224', 'bank_buying': '4174'}
2025-11-26 12:40:32,854 - INFO - Data validation result: Prices={'bank_selling_price': 4224.0, 'bank_buying_price': 4174.0}, Status=OK
2025-11-26 12:40:32,855 - INFO - Successfully inserted data into the database.
2025-11-26 13:33:28,991 - INFO - Starting ETL process...
2025-11-26 13:33:29,494 - INFO - Successfully fetched raw data: {'bank_selling': '4224', 'bank_buying': '4174'}
2025-11-26 13:33:29,494 - INFO - Data validation result: Prices={'bank_selling_price': 4224.0, 'bank_buying_price': 4174.0}, Status=OK
2025-11-26 13:33:29,496 - INFO - Successfully inserted data into the database.
2025-11-26 14:19:47,691 - INFO - Starting ETL process...
2025-11-26 14:19:48,203 - INFO - Successfully fetched raw data: {'bank_selling': '4224', 'bank_buying': '4174'}
2025-11-26 14:19:48,203 - INFO - Data validation result: Prices={'bank_selling_price': 4224.0, 'bank_buying_price': 4174.0}, Status=OK
2025-11-26 14:19:48,204 - INFO - Successfully inserted data into the database.
2025-11-26 15:18:07,838 - INFO - Starting ETL process...
2025-11-26 15:18:08,414 - INFO - Successfully fetched raw data: {'bank_selling': '4224', 'bank_buying': '4174'}
2025-11-26 15:18:08,415 - INFO - Data validation result: Prices={'bank_selling_price': 4224.0, 'bank_buying_price': 4174.0}, Status=OK
2025-11-26 15:18:08,416 - INFO - Successfully inserted data into the database.
2025-11-26 16:24:02,347 - INFO - Starting ETL process...
2025-11-26 16:24:02,710 - INFO - Successfully fetched raw data: {'bank_selling': '4224', 'bank_buying': '4174'}
2025-11-26 16:24:02,710 - INFO - Data validation result: Prices={'bank_selling_price': 4224.0, 'bank_buying_price': 4174.0}, Status=OK
2025-11-26 16:24:02,712 - INFO - Successfully inserted data into the database.
2025-11-26 17:17:29,510 - INFO - Starting ETL process...
2025-11-26 17:17:29,935 - INFO - Successfully fetched raw data: {'bank_selling': '4224', 'bank_buying': '4174'}
2025-11-26 17:17:29,935 - INFO - Data validation result: Prices={'bank_selling_price': 4224.0, 'bank_buying_price': 4174.0}, Status=OK
2025-11-26 17:17:29,938 - INFO - Successfully inserted data into the database.
2025-11-26 17:23:27,489 - INFO - Starting ETL process...
2025-11-26 17:23:28,848 - INFO - Successfully fetched raw data: {'bank_selling': '4224', 'bank_buying': '4174'}
2025-11-26 17:23:28,848 - INFO - Data validation result: Prices={'bank_selling_price': 4224.0, 'bank_buying_price': 4174.0}, Status=OK
2025-11-26 17:23:28,851 - INFO - Successfully inserted data into the database.
2025-11-26 18:24:17,284 - INFO - Starting ETL process...
2025-11-26 18:24:17,791 - INFO - Successfully fetched raw data: {'bank_selling': '4224', 'bank_buying': '4174'}
2025-11-26 18:24:17,791 - INFO - Data validation result: Prices={'bank_selling_price': 4224.0, 'bank_buying_price': 4174.0}, Status=OK
2025-11-26 18:24:17,794 - INFO - Successfully inserted data into the database.
2025-11-26 19:14:47,514 - INFO - Starting ETL process...
2025-11-26 19:14:47,933 - INFO - Successfully fetched raw data: {'bank_selling': '4224', 'bank_buying': '4174'}
2025-11-26 19:14:47,933 - INFO - Data validation result: Prices={'bank_selling_price': 4224.0, 'bank_buying_price': 4174.0}, Status=OK
2025-11-26 19:14:47,936 - INFO - Successfully inserted data into the database.
2025-11-26 20:20:30,025 - INFO - Starting ETL process...
2025-11-26 20:20:31,588 - INFO - Successfully fetched raw data: {'bank_selling': '4224', 'bank_buying': '4174'}
2025-11-26 20:20:31,588 - INFO - Data validation result: Prices={'bank_selling_price': 4224.0, 'bank_buying_price': 4174.0}, Status=OK
2025-11-26 20:20:31,590 - INFO - Successfully inserted data into the database.
2025-11-26 21:16:46,854 - INFO - Starting ETL process...
2025-11-26 21:16:48,031 - INFO - Successfully fetched raw data: {'bank_selling': '4224', 'bank_buying': '4174'}
2025-11-26 21:16:48,032 - INFO - Data validation result: Prices={'bank_selling_price': 4224.0, 'bank_buying_price': 4174.0}, Status=OK
2025-11-26 21:16:48,034 - INFO - Successfully inserted data into the database.
2025-11-26 22:17:54,400 - INFO - Starting ETL process...
2025-11-26 22:17:55,114 - INFO - Successfully fetched raw data: {'bank_selling': '4224', 'bank_buying': '4174'}
2025-11-26 22:17:55,114 - INFO - Data validation result: Prices={'bank_selling_price': 4224.0, 'bank_buying_price': 4174.0}, Status=OK
2025-11-26 22:17:55,117 - INFO - Successfully inserted data into the database.
